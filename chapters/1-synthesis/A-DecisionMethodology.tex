\section{Sample AHP and TOPSIS calculation for product selection}
\label{app:matrix}


\paragraph{1. Pair-wise comparison of criteria}
The scale developed by Saaty was adopted to assess the relative importance of one criteria compared to another \cite{saaty_analytic_1987}. The fundamental scale is as follows: 1 for equal importance, 3 for moderate importance of one criteria over the other, 5 for essential or strong importance, 7 for very strong importance and 9 for extreme importance. Even numbers can be used as intermediate values. The normalised weightings were then calculated. The results for product selection are shown in \Cref{tab:pairwise}. Environmental and safety considerations were valued as more important than other criteria, in line with Nitroma's commitment to develop an inherently safer process. Process complexity was given the lowest weighting since each route exhibited similar complexities to achieve a multipurpose plant.  

\begin{table}[H]
\centering
\caption{Pair-wise criteria comparison for product selection}
\label{tab:pairwise}
\begin{tabularx}{\linewidth}{l|XXX|l}
\toprule
                                                                & Economic potential & Process complexity & Environmental and safety & Weights \\ \midrule
Economic potential                        & 1.000              & 3.000              & 0.333                    & 0.286   \\
Process complexity                      & 0.333              & 1.000              & 0.333                    & 0.14    \\
Environmental and   safety & 3.000              & 3.000              & 1.000                    & 0.574   \\ \midrule
Sum                                      & 4.333              & 7.000              & 1.667                    &                              \\ \bottomrule
\end{tabularx}
\end{table}


\paragraph{2. Validation of consistency}
The consistency between the weightings was verified with a method proposed by Saaty \cite{saaty_analytic_1987}. The largest eigenvalue ($\lambda_{max}$) was determine with the following formula where $i$ refers to the criteria:
\begin{equation}
    \lambda_{max}=\sum_{i} \mathrm{w}_{i}\cdot \mathrm{Sum}(i)
\end{equation}
The consistency index (CI) is calculated for the number of criteria $n$:
\begin{equation}
   \mathrm{CI} = \frac{\lambda_{max}-n}{n-1}
\end{equation}
The consistency ratio CI/RI is then calculated using the Random Consistency Index (RI) retrieved from \cite{saaty_analytic_1987}.
For product selection, $\lambda_{max}=3.036$, $\mathrm{CI}=0.018$ and $\mathrm{RI}=0.58$, hence the consistency ratio is 0.03. Weightings are deemed consistent if the ratio is less than \SI{10}{\percent}.

\paragraph{3. AHP score calculation}
The score for a given alternative is calculated by summing, over all criteria, the normalised score multiplied by the criteria weighting:
\begin{equation}
    S=\sum^{i}_{n}(\tilde{p}_{in} \cdot w_{i})
\end{equation}

\paragraph{4. Weighted normalised matrix for TOPSIS}
Similarly to AHP analysis, a $n\times k$ matrix is constructed for $n$ criteria and $k$ alternatives. The criteria $X_{ij}$ are normalised and multiplied by their respective weighting $w_i$ as follows:
\begin{align}
    \tilde{X}_{ij}&=\frac{X_{ij}}{\sqrt{\sum^{n}_{i=1}X_{ij}^{2}}} &
    V_{ij}&=\tilde{X}_{ij}\times w_j
\end{align}

\paragraph{5. Calculation of Euclidean distance from ideal best and ideal worst}
The ideal best ($V_{j}^{+}$) and ideal worst ($V_{j}^{-}$) are the maximum and minimum values for each criterion. The distance from the ideal best and ideal worst values is calculated as follows:
\begin{align}
    S_{i}^{+}&=\sqrt{\sum_{j=1}^{n}(V_{ij}-V_{j}^{+})^2} &
    S_{i}^{-}&=\sqrt{\sum_{j=1}^{n}(V_{ij}-V_{j}^{-})^2}
\end{align}

\paragraph{6. Evaluation of performance score and ranking}
Finally the performance score is the ratio between the Euclidian distance from the ideal worst and the sum of Euclidian distances. The highest score indicates the most optimum solution.
\begin{equation}
    P_{i}=\frac{S_{i}^{-}}{S_{i}^{+}+S_{i}^{-}}
\end{equation}







